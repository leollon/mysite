#!/bin/bash

set -o errexit

# create volumes's source before build images,
# otherwise PermissionError or FileNotFoundError occurs 
# when container runs.

mkdir -p var/log run data captcha markdown dj_static "$HOME/static/"

if [ -e "./postgresql" ]
then
    sudo chown -R "${USER}":"${USER}" ./postgresql;
fi

docker-compose -f local.yml up "$@"     # start building images
cp -ruv dj_static/* "$HOME/static/"
cp -ruv frontend/static/* "$HOME/static/"
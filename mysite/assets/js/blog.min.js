function markdownToHtmlHandler(t){let e=new showdown.Converter;return e.setFlavor("github"),e.makeHtml(t)}function getCSRFToken(){return $("input[name='csrfmiddlewaretoken']").attr("value")}function setCaptcha(){$.getJSON("/refresh/captcha/",function(t){$("#captcha").attr("src",t.captchaImgPath)})}"undefined"!==$("#article-editor")[0]&&$("#menu-toggle").trigger("click"),$("#id_title").on("input",function(){$("#article-title").text($("#id_title").val())}),$("#id_article_body").on("input",function(){$("#article-preview-body").html(markdownToHtmlHandler($("#id_article_body").val()))}),$.ajaxSetup({beforeSend:function(t,e){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(e.type)||this.crossDomain||t.setRequestHeader("X-CSRFToken",getCSRFToken())},error:function(t){console.log(t)}}),$("#captcha-input").on("input",function(t){$("#captcha-hint").css("display","none")}),$("#comment-form").submit(function(t){if(t.preventDefault(),""!=$("#captcha-input").val()){var e=new FormData($("#comment-form")[0]);e&&$.ajax({url:"/comment/new/",type:"POST",cache:!1,data:e,enctype:"multipart/form-data",processData:!1,contentType:!1,success:function(t,e,n){window.location.reload()},error:function(t,e,n){console.log(t,e,n)}})}else $("#captcha-hint").css("display","block")}),$(".reply").click(function(t){var e=$("#id_comment_text").val(),n="@".concat(this.dataset.commenter);e.indexOf(n)<0&&$("#id_comment_text").val(n.concat(" ").concat(e))}),$("#captcha").click(setCaptcha),$("#captcha").ready(setCaptcha);